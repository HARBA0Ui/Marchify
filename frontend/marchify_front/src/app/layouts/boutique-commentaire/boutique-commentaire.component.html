<div class="p-6 bg-white rounded-lg shadow-md">

    <h2 class="text-xl font-bold mb-4">Avis sur la boutique</h2>

    <p class="text-gray-600 mb-3">
        ⭐ <span class="text-yellow-500">{{ avgRating() }}</span> / 5
    </p>

    <!-- Liste des avis -->
    <ng-container *ngIf="reviews().length > 0; else noReview">
        <div *ngFor="let review of reviews()" class="border-b pb-3 mb-3">

            <p class="font-bold text-gray-800">
                {{ review.auteur?.nom || review.auteur?.prenom || 'Anonyme' }}
            </p>

            <!-- Étoiles -->
            <div class="mb-1 flex items-center">
                <ng-container *ngFor="let star of [1,2,3,4,5]">
                    <span class="text-2xl" [class.text-yellow-400]="star <= review.rating"
                        [class.text-gray-300]="star > review.rating">
                        ★
                    </span>
                </ng-container>
            </div>

            <p class="text-gray-700">{{ review.comment }}</p>
        </div>
    </ng-container>

    <!-- Aucun avis -->
    <ng-template #noReview>
        <p class="text-gray-500 italic">Aucun avis pour le moment.</p>
    </ng-template>


    <!-- Zone ajout avis -->
    <div class="mt-6">

        <label class="block mb-1 font-medium text-gray-800">Votre note</label>
        <div class="mb-3 flex items-center">
            <ng-container *ngFor="let star of [1,2,3,4,5]">
                <span class="cursor-pointer text-3xl mr-1 transition" (click)="setRating(star)"
                    [class.text-yellow-400]="star <= newRating" [class.text-gray-300]="star > newRating">
                    ★
                </span>
            </ng-container>
        </div>

        <label class="block mb-1 font-medium text-gray-800">Votre commentaire</label>
        <textarea [(ngModel)]="newComment"
            class="w-full border rounded p-3 mb-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-400"
            placeholder="Écrivez votre avis..." rows="4"></textarea>

        <p *ngIf="newComment.trim().length > 0 && newComment.trim().length < 6" class="text-sm text-red-600 mb-2">
            Le commentaire doit contenir au moins 6 caractères.
        </p>

        <div class="flex items-center gap-3 mt-2">
            <button (click)="addComment()" [disabled]="!isCommentValid()"
                class="bg-yellow-500 text-white px-4 py-2 rounded shadow hover:bg-yellow-600 disabled:opacity-40">
                Publier
            </button>
        </div>
    </div>

</div>